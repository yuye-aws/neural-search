please check run.ipynb for more details